<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Console - Dora's Tropical Adventure</title>
    <link rel="stylesheet" href="/static/css/admin.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>Prolog Sessions</h2>
                <div style="font-size: 11px; color: #8b949e;">Admin Full Access</div>
            </div>

            <!-- Mode Switch -->
            <div class="mode-switch">
                <button id="shellModeBtn" class="mode-btn active" onclick="switchMode('shell')">Shell Mode</button>
                <button id="guiModeBtn" class="mode-btn" onclick="switchMode('gui')">GUI Mode</button>
            </div>

            <button class="new-session-btn" onclick="createNewSession()">+ Create New Session</button>
            <div class="session-list" id="sessionList">
                <div style="padding: 20px; color: #8b949e; text-align: center;">Loading...</div>
            </div>
        </div>

        <div class="main-content">
            <!-- Shell Mode Interface -->
            <div id="shellArea" style="display: none; flex: 1; flex-direction: column;">
                <div class="toolbar">
                    <div class="session-info" id="currentSessionInfo">No session selected</div>
                    <button onclick="refreshOutput()">Refresh Output</button>
                    <button onclick="clearOutput()">Clear Display</button>
                    <button class="danger" onclick="killSession()">Kill Session</button>
                </div>

                <div class="quick-queries">
                    <label>Quick Queries:</label>
                    <button onclick="quickQuery('listing(player_location/1).')">Player Location</button>
                    <button onclick="quickQuery('listing(swiper_location/1).')">Swiper Location</button>
                    <button onclick="quickQuery('player_backpack(L), write(L), nl.')">Backpack Items</button>
                    <button onclick="quickQuery('findall((R,I), room_has_item(R,I), L), write(L), nl.')">Room Items</button>
                    <button onclick="quickQuery('findall((L,I), swiper_hidden_item(L,I), R), write(R), nl.')">Hidden Items</button>
                    <button onclick="quickQuery('player_score(S), game_time(T), format(\"Score: ~w, Time: ~w\", [S,T]).')">Score/Time</button>
                    <button onclick="quickQuery('listing.')">Full Listing</button>
                </div>

                <div class="shell-container">
                    <div class="shell-output" id="shellOutput">
                        <span class="system">Select a session to start...</span>
                    </div>

                    <div class="shell-input-area">
                        <span class="prompt-label">?-</span>
                        <input type="text" id="shellInput" placeholder="Enter Prolog command..."
                               onkeydown="handleShellKeyDown(event)" autocomplete="off">
                        <button onclick="sendShellCommand()">Execute</button>
                    </div>
                </div>
            </div>

            <!-- GUI Mode Interface -->
            <div id="guiArea" style="display: none; flex: 1; flex-direction: column;">
                <div class="toolbar">
                    <div class="session-info" id="guiSessionInfo">No session selected</div>
                    <button onclick="guiRefresh()">Refresh Status</button>
                    <button onclick="clearGuiOutput()">Clear Output</button>
                    <button class="danger" onclick="killSession()">Kill Session</button>
                </div>

                <div class="gui-container">
                    <!-- Status Panel -->
                    <div class="gui-status-panel">
                        <div class="status-card">
                            <h4>Player Status</h4>
                            <div id="guiPlayerLocation">Location: -</div>
                            <div id="guiPlayerScore">Score: -</div>
                            <div id="guiGameTime">Time: -</div>
                        </div>
                        <div class="status-card swiper-card">
                            <h4>Swiper Status</h4>
                            <div id="guiSwiperLocation">Location: -</div>
                            <div id="guiSwiperCarrying">Carrying: -</div>
                            <div id="guiSwiperStatus">Status: Active</div>
                        </div>
                        <div class="status-card">
                            <h4>Backpack</h4>
                            <div id="guiBackpack">Empty</div>
                        </div>
                        <div class="status-card">
                            <h4>Hidden Items</h4>
                            <div id="guiHiddenItems">None</div>
                        </div>
                    </div>

                    <!-- Game Output -->
                    <div class="gui-output" id="guiOutput">
                        <span class="system">Select a session to start playing...</span>
                    </div>

                    <!-- Game Commands -->
                    <div class="gui-commands">
                        <div class="command-group">
                            <label>Move:</label>
                            <button onclick="guiCommand('go(north)')">N</button>
                            <button onclick="guiCommand('go(south)')">S</button>
                            <button onclick="guiCommand('go(east)')">E</button>
                            <button onclick="guiCommand('go(west)')">W</button>
                        </div>
                        <div class="command-group">
                            <label>Actions:</label>
                            <button onclick="guiCommand('look')">Look</button>
                            <button onclick="guiCommand('inventory')">Inventory</button>
                            <button onclick="guiCommand('status')">Status</button>
                            <button onclick="guiCommand('boots_search')">Boots Search</button>
                            <button onclick="guiCommand('stop_swiper')">Stop Swiper</button>
                        </div>
                        <div class="command-group">
                            <label>Items:</label>
                            <input type="text" id="guiItemInput" placeholder="Item name..." style="width: 120px;">
                            <button onclick="guiTakeItem()">Take</button>
                            <button onclick="guiDropItem()">Drop</button>
                            <button onclick="guiUseItem()">Use</button>
                        </div>
                    </div>

                    <!-- Custom Command -->
                    <div class="gui-custom-command">
                        <input type="text" id="guiCustomInput" placeholder="Enter game command..."
                               onkeydown="handleGuiKeyDown(event)">
                        <button onclick="sendGuiCommand()">Send</button>
                    </div>
                </div>
            </div>

            <!-- No Session Prompt -->
            <div id="noSessionArea" class="no-session">
                <div style="text-align: center;">
                    <div style="font-size: 48px; margin-bottom: 20px;">$_</div>
                    <div>Select a session from the left or create a new one</div>
                    <div style="margin-top: 10px; font-size: 12px;">Admin can execute any Prolog command</div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/admin.js"></script>
</body>
</html>
